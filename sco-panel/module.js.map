{"version":3,"file":"module.js","mappings":"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","sources":["webpack://retail-sco-panel/external amd \"@grafana/ui\"","webpack://retail-sco-panel/external amd \"@emotion/css\"","webpack://retail-sco-panel/external amd \"module\"","webpack://retail-sco-panel/external amd \"@grafana/runtime\"","webpack://retail-sco-panel/external amd \"@grafana/data\"","webpack://retail-sco-panel/external amd \"react\"","webpack://retail-sco-panel/webpack/bootstrap","webpack://retail-sco-panel/webpack/runtime/compat get default export","webpack://retail-sco-panel/webpack/runtime/define property getters","webpack://retail-sco-panel/webpack/runtime/hasOwnProperty shorthand","webpack://retail-sco-panel/webpack/runtime/make namespace object","webpack://retail-sco-panel/webpack/runtime/publicPath","webpack://retail-sco-panel/./node_modules/grafana-public-path.js","webpack://retail-sco-panel/./services/CalculateFontSize.ts","webpack://retail-sco-panel/./components/Section.tsx","webpack://retail-sco-panel/./utils/prepareNumber.ts","webpack://retail-sco-panel/./utils/getColorTextByValue.ts","webpack://retail-sco-panel/./components/SimplePanel.tsx","webpack://retail-sco-panel/./module.ts"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__7__;","module.exports = __WEBPACK_EXTERNAL_MODULE__89__;","module.exports = __WEBPACK_EXTERNAL_MODULE__308__;","module.exports = __WEBPACK_EXTERNAL_MODULE__531__;","module.exports = __WEBPACK_EXTERNAL_MODULE__781__;","module.exports = __WEBPACK_EXTERNAL_MODULE__959__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"public/plugins/retail-sco-panel/\";","\nimport amdMetaModule from 'amd-module';\n\n__webpack_public_path__ =\n  amdMetaModule && amdMetaModule.uri\n    ? amdMetaModule.uri.slice(0, amdMetaModule.uri.lastIndexOf('/') + 1)\n    : 'public/plugins/retail-sco-panel/';\n","export class FontSizeCalculator {\n  private baseSize: number;\n  private minSize: number;\n  private maxSize: number;\n\n  constructor(baseSize: number = 34, minSize: number = 16, maxSize: number = 60) {\n    this.baseSize = baseSize;\n    this.minSize = minSize;\n    this.maxSize = maxSize;\n  }\n\n  // Геттеры для доступа к размерам\n  getBaseSize(): number {\n    return this.baseSize;\n  }\n\n  getMinSize(): number {\n    return this.minSize;\n  }\n\n  getMaxSize(): number {\n    return this.maxSize;\n  }\n\n  // Сеттеры для изменения размеров\n  setBaseSize(size: number): void {\n    this.baseSize = size;\n  }\n\n  setMinSize(size: number): void {\n    this.minSize = size;\n  }\n\n  setMaxSize(size: number): void {\n    this.maxSize = size;\n  }\n\n  // Основной метод расчета размера шрифта\n  calculateValueFontSize(containerWidth: number, containerHeight: number, text: string): number {\n    // Коэффициенты для адаптации размера\n    const widthFactor = containerWidth / 200; // 200px как базовая ширина\n    const heightFactor = containerHeight / 150; // 150px как базовая высота\n    \n    // Учитываем длину текста\n    const textLengthFactor = Math.max(0.8, 1 - (text.length - 5) * 0.05);\n    \n    // Вычисляем размер с учетом всех факторов\n    let calculatedSize = this.baseSize * widthFactor * heightFactor * textLengthFactor;\n    \n    // Ограничиваем размеры\n    return Math.max(this.minSize, Math.min(this.maxSize, calculatedSize));\n  }\n\n  // Статический метод для создания стандартного калькулятора\n  static createDefault(): FontSizeCalculator {\n    return new FontSizeCalculator(34, 26, 60);\n  }\n\n  // Метод для создания калькулятора с кастомными размерами\n  static createCustom(baseSize: number, minSize: number, maxSize: number): FontSizeCalculator {\n    return new FontSizeCalculator(baseSize, minSize, maxSize);\n  }\n}\n\n// // Экспортируем функцию для обратной совместимости\n// export const calculateValueFontSize = (containerWidth: number, containerHeight: number, text: string) => {\n//   return FontSizeCalculator.createDefault().calculateValueFontSize(containerWidth, containerHeight, text);\n// };","import React, { useRef, useEffect, useState } from 'react';\nimport { css, cx } from '@emotion/css';\nimport { useStyles2 } from '@grafana/ui';\nimport { getColorTextByValue, prepareNumber } from 'utils';\nimport { FontSizeCalculator } from 'services';\n\ninterface Props {\n  title: string;\n  value: number | undefined;\n  className?: string;\n}\n\nconst getStyles = () => {\n  return {\n    section: css`\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      padding: 4px;\n      border-radius: 4px;\n      border: 1px solid rgba(204, 204, 220, 0.12);\n      position: relative;\n      overflow: hidden;\n    `,\n    title: css`\n      margin: 0px;\n      position: absolute;\n      top: 4px;\n      left: 6px;\n    `,\n    value: css`\n      font-weight: bold;\n      text-align: center;\n    `,\n  };\n};\n\nexport const Section: React.FC<Props> = ({ title, value, className }) => {\n  const sectionRef = useRef<HTMLDivElement>(null);\n  const calculator = new FontSizeCalculator();\n  const styles = useStyles2(getStyles);\n  const [valueFontSize, setValueFontSize] = useState(34);\n\n  const preparedValue = value === undefined ? '~' : prepareNumber(value);\n  const color = getColorTextByValue(value || 0);\n\n  useEffect(() => {\n    const updateValueFontSize = () => {\n      if (sectionRef.current) {\n        const rect = sectionRef.current.getBoundingClientRect();\n        const width = rect.width;\n        const height = rect.height;\n        \n        const newValueSize = calculator.calculateValueFontSize(width, height, preparedValue);\n        setValueFontSize(newValueSize);\n      }\n    };\n\n    updateValueFontSize();\n\n    const resizeObserver = new ResizeObserver(updateValueFontSize);\n    \n    if (sectionRef.current) {\n      resizeObserver.observe(sectionRef.current);\n    }\n\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [preparedValue]);\n\n  return (\n    <div ref={sectionRef} className={cx(styles.section, className)}>\n      <h6 className={styles.title}>{title}</h6>\n      <span className={cx(styles.value, css`color: ${color}; font-size: ${valueFontSize}px`)}>\n        {preparedValue}\n      </span>\n    </div>\n  );\n};","export const prepareNumber = (value: number, precision: number = 2) => {\n  return Number.isInteger(value) ? value.toString() : value.toFixed(precision);\n};","export const getColorTextByValue = (value: number | undefined): string => {\n  if (!value) return '#ff9900';\n\n  if (value >= 0 && value < 5) {\n    return '#5794f2';\n  } else if (value >= 0 && value < 50) {\n    return '#73BF69';\n  } else if (value >= 50 && value < 80) {\n    return '#EAB839';\n  } else if (value >= 80 && value <= 100) {\n    return '#E24D42';\n  }\n\n  return '#ff9900';\n};","import React from 'react';\nimport { PanelProps } from '@grafana/data';\nimport { SimpleOptions } from 'types';\nimport { css, cx } from '@emotion/css';\nimport { useStyles2 } from '@grafana/ui';\nimport { PanelDataErrorView } from '@grafana/runtime';\nimport { Section } from './Section';\n\ninterface Props extends PanelProps<SimpleOptions> {}\n\nconst getStyles = () => {\n  return {\n    wrapper: css`\n\n      position: relative;\n    `,\n    adaptiveText: css`\n      font-size: clamp(0.75rem, 2.5vw, 1.5rem);\n      line-height: 1.2;\n    `,\n    grid: css`\n      width: 100%;\n      height: 100%;\n      display: grid;\n      grid-template:\n        \"a a a b b b c\" 1fr\n        \"a a a b b b d\" 1fr\n        \"a a a b b b e\" 1fr /\n        1fr 1fr 1fr 1fr 1fr 1fr 1fr;\n      gap: 4px;\n    `,\n    a: css`grid-area: a;`,\n    b: css`grid-area: b;`,\n    c: css`grid-area: c;`,\n    d: css`grid-area: d;`,\n    e: css`grid-area: e;`,\n  };\n};\n\nexport const SimplePanel: React.FC<Props> = ({ options, data, width, height, fieldConfig, id }) => {\n  const styles = useStyles2(getStyles);\n\n  if (data.series.length === 0) {\n    return <PanelDataErrorView fieldConfig={fieldConfig} panelId={id} data={data} needsStringField />;\n  }\n\n  const radii = data.series\n    .map((series) => series.fields.find((field) => field.type === 'number'))\n    .map((field) => field?.values.get(field.values.length - 1));\n\n  return (\n    <div\n      className={cx(\n        styles.wrapper,\n        css`\n          width: ${width}px;\n          height: ${height}px;\n        `\n      )}\n    >\n      <div className={styles.grid}>\n        <Section title={options.a} className={styles.a} value={radii[0]} />\n        <Section title={options.b} className={styles.b} value={radii[1]} />\n        <Section title={options.c} className={styles.c} value={radii[2]} />\n        <Section title={options.d} className={styles.d} value={radii[3]} />\n        <Section title={options.e} className={styles.e} value={radii[4]} />\n      </div>\n    </div>\n  );\n};\n","import { PanelPlugin } from '@grafana/data';\nimport { SimpleOptions } from './types';\nimport { SimplePanel } from './components/SimplePanel';\n\nexport const plugin = new PanelPlugin<SimpleOptions>(SimplePanel).setPanelOptions((builder) => {\n  return builder\n    .addTextInput({\n      path: 'a',\n      name: 'Title block A',\n      defaultValue: 'CPU SCO',\n    })\n    .addTextInput({\n      path: 'b',\n      name: 'Title block B',\n      defaultValue: 'CPU RFID',\n    })\n    .addTextInput({\n      path: 'c',\n      name: 'Title block C',\n      defaultValue: '',\n    })\n    .addTextInput({\n      path: 'd',\n      name: 'Title block D',\n      defaultValue: '',\n    })\n    .addTextInput({\n      path: 'e',\n      name: 'Title block E',\n      defaultValue: '',\n    });\n});\n"],"names":["module","exports","__WEBPACK_EXTERNAL_MODULE__7__","__WEBPACK_EXTERNAL_MODULE__89__","__WEBPACK_EXTERNAL_MODULE__308__","__WEBPACK_EXTERNAL_MODULE__531__","__WEBPACK_EXTERNAL_MODULE__781__","__WEBPACK_EXTERNAL_MODULE__959__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","p","slice","lastIndexOf","FontSizeCalculator","getBaseSize","this","baseSize","getMinSize","minSize","getMaxSize","maxSize","setBaseSize","size","setMinSize","setMaxSize","calculateValueFontSize","containerWidth","containerHeight","text","widthFactor","heightFactor","textLengthFactor","Math","max","length","calculatedSize","min","createDefault","createCustom","constructor","getStyles","section","css","title","Section","className","sectionRef","useRef","calculator","styles","useStyles2","valueFontSize","setValueFontSize","useState","preparedValue","precision","Number","isInteger","toString","toFixed","prepareNumber","color","getColorTextByValue","useEffect","updateValueFontSize","current","rect","getBoundingClientRect","width","height","newValueSize","resizeObserver","ResizeObserver","observe","disconnect","div","ref","cx","h6","span","wrapper","adaptiveText","grid","b","c","e","plugin","PanelPlugin","options","data","fieldConfig","id","series","PanelDataErrorView","panelId","needsStringField","radii","map","fields","find","field","type","values","setPanelOptions","builder","addTextInput","path","name","defaultValue"],"sourceRoot":""}